<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å€’é€€åš•å°æé¾</title>
    <style>
        /* --- CSS æ¨£å¼å€ --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #222;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            user-select: none; /* é˜²æ­¢é¸å–æ–‡å­— */
        }

        .container {
            text-align: center;
            width: 100%;
            max-width: 800px;
        }

        h1 { color: #f1c40f; margin-bottom: 10px; }

        /* ç‹€æ…‹åˆ— */
        .status-bar {
            display: flex;
            justify-content: space-between;
            padding: 10px 20px;
            background: #333;
            border-radius: 8px 8px 0 0;
            font-size: 1.2rem;
            font-weight: bold;
        }
        #timer { color: #e74c3c; }
        #speed-display { color: #3498db; }

        /* éŠæˆ²è¦–çª— */
        #game-window {
            position: relative;
            width: 100%;
            height: 250px;
            background-color: #fff;
            border: 4px solid #333;
            overflow: hidden;
            margin: 0 auto;
        }

        /* åœ°æ¿ */
        #ground {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 10px;
            background: linear-gradient(to right, #333 50%, transparent 50%);
            background-size: 40px 100%;
        }

        /* åœ°æ¿æ»¾å‹•å‹•ç•« Class */
        .scrolling-bg {
            animation: scrollGround 0.5s linear infinite;
        }

        @keyframes scrollGround {
            from { background-position: 0 0; }
            to { background-position: -40px 0; }
        }

        /* å¤©ç©º */
        #sky {
            position: absolute;
            top: 20px;
            width: 100%;
            color: #bbb;
            font-size: 2rem;
            z-index: 1;
        }

        /* å°æé¾ */
        #dino {
            position: absolute;
            bottom: 10px;
            left: 50px;
            width: 50px;
            height: 50px;
            font-size: 45px;
            z-index: 10;
            line-height: 1;
            /* ä¿®æ­£ emoji å°é½Šå•é¡Œ */
            display: flex;
            align-items: flex-end; 
        }

        /* è·³èºå‹•ç•« */
        .anim-jump-low { animation: jumpLow 0.5s ease-in-out; }
        @keyframes jumpLow {
            0% { bottom: 10px; }
            50% { bottom: 90px; }
            100% { bottom: 10px; }
        }

        .anim-jump-high { animation: jumpHigh 0.7s ease-in-out; }
        @keyframes jumpHigh {
            0% { bottom: 10px; }
            50% { bottom: 160px; }
            100% { bottom: 10px; }
        }

        /* éšœç¤™ç‰© */
        .cactus {
            position: absolute;
            bottom: 10px;
            font-size: 30px;
            line-height: 1;
            z-index: 5;
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }

        .cactus-small {
            height: 40px;
            width: 30px;
            font-size: 35px;
        }
        .cactus-small::after { content: 'ğŸŒµ'; }

        .cactus-tall {
            height: 70px;
            width: 40px;
            font-size: 55px;
        }
        .cactus-tall::after { content: 'ğŸŒµ'; filter: hue-rotate(45deg); }

        /* æ§åˆ¶å€ */
        #message {
            margin: 10px 0;
            height: 1.5rem;
            color: #e67e22;
            font-weight: bold;
        }

        .controls-area {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }

        button {
            padding: 10px 25px;
            font-size: 1.1rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.1s;
        }
        button:active { transform: scale(0.95); }

        #start-btn { background-color: #f1c40f; color: #333; width: 220px; }
        #start-btn:disabled { background-color: #555; color: #aaa; cursor: default; transform: none; box-shadow: none; }

        .jump-controls { display: flex; gap: 20px; }
        .action-btn { color: white; min-width: 140px; }
        .small-jump { background-color: #27ae60; }
        .big-jump { background-color: #e67e22; }

        .hint { font-size: 0.9rem; color: #888; margin-top: 15px; }
    </style>
</head>
<body>

    <div class="container">
        <h1>Michelå°æé¾ğŸ¦–</h1>
        
        <div class="status-bar">
            <div class="timer-box">å‰©é¤˜æ™‚é–“ï¼š<span id="timer">60</span> ç§’</div>
            <div class="speed-box">é€Ÿåº¦ï¼š<span id="speed-display">1.0</span>x</div>
        </div>

        <div id="game-window">
            <div id="sky">â˜ï¸ &nbsp; &nbsp; â˜ï¸</div>
            <div id="dino">ğŸ¦–</div>
            <div id="ground"></div>
        </div>

        <div id="message">READYï¼Ÿ</div>

        <div class="controls-area">
            <button id="start-btn" onclick="startGame()">GO!!!</button>
            <div class="jump-controls">
                <button class="action-btn small-jump" onclick="jumpLow()">å°è·³ (Céµ)</button>
                <button class="action-btn big-jump" onclick="jumpHigh()">å¤§è·³.JPG (SPACE)</button>
            </div>
        </div>
        <p class="hint">HINTï¼šé«˜ä»™äººæŒç”¨å¤§è·³ï¼ŒçŸ®ä»™äººæŒç”¨å°è·³ã€‚</p>
    </div>

    <script>
        /* --- JavaScript é‚è¼¯å€ --- */
        
        // å–å¾— DOM å…ƒç´ 
        const dino = document.getElementById('dino');
        const gameWindow = document.getElementById('game-window');
        const ground = document.getElementById('ground');
        const timerEl = document.getElementById('timer');
        const speedEl = document.getElementById('speed-display');
        const msgEl = document.getElementById('message');
        const startBtn = document.getElementById('start-btn');

        // éŠæˆ²è®Šæ•¸
        let isGameRunning = false;
        let hasGameEnded = false; // é˜²æ­¢é‡è¤‡é–‹å§‹
        let frameId = null;       // å‹•ç•« ID
        let gameTime = 60;        // éŠæˆ²æ™‚é–“
        let timerInterval = null; // è¨ˆæ™‚å™¨ ID

        // é€Ÿåº¦èˆ‡éšœç¤™ç‰©è®Šæ•¸
        let gameSpeed = 5;       // åˆå§‹åƒç´ ç§»å‹•é€Ÿåº¦
        let speedMultiplier = 1; // é€Ÿåº¦å€ç‡
        let obstacles = [];      // éšœç¤™ç‰©é™£åˆ—
        let spawnTimer = 0;      // ç”¢ç”Ÿéšœç¤™ç‰©çš„è¨ˆæ•¸å™¨

        // éµç›¤ç›£è½
        document.addEventListener('keydown', (e) => {
            if (!isGameRunning) return; // éŠæˆ²æ²’é–‹å§‹æŒ‰éµæ²’åæ‡‰
            
            // ç©ºç™½éµ æˆ– ä¸Šç®­é ­ -> å¤§è·³
            if (e.code === 'Space' || e.code === 'ArrowUp') {
                e.preventDefault(); // é˜²æ­¢ç¶²é æ»¾å‹•
                jumpHigh();
            }
            // Céµ æˆ– ä¸‹ç®­é ­ -> å°è·³
            if (e.code === 'KeyC' || e.code === 'ArrowDown') {
                e.preventDefault();
                jumpLow();
            }
        });

        // --- æ ¸å¿ƒåŠŸèƒ½ï¼šé–‹å§‹éŠæˆ² ---
        function startGame() {
            // å¦‚æœéŠæˆ²æ­£åœ¨é€²è¡Œ æˆ– å·²ç¶“çµæŸéï¼Œå°±ä¸èƒ½å†åŸ·è¡Œ
            if (isGameRunning || hasGameEnded) return;

            console.log("éŠæˆ²é–‹å§‹ï¼"); // é™¤éŒ¯è¨Šæ¯

            isGameRunning = true;
            
            // æ›´æ–° UI
            startBtn.disabled = true;
            startBtn.innerText = "éŠæˆ²é€²è¡Œä¸­...";
            msgEl.innerText = "å¥”è·‘ä¸­...";
            
            // å•Ÿå‹•åœ°æ¿å‹•ç•«
            ground.classList.add('scrolling-bg');

            // å•Ÿå‹•å€’æ•¸è¨ˆæ™‚å™¨
            timerInterval = setInterval(() => {
                gameTime--;
                timerEl.innerText = gameTime;
                
                // æ¯ 5 ç§’åŠ é€Ÿ
                if (gameTime % 5 === 0) {
                    increaseSpeed();
                }

                // æ™‚é–“åˆ°ï¼Œç²å‹
                if (gameTime <= 0) {
                    gameWin();
                }
            }, 1000);

            // å•Ÿå‹•éŠæˆ²ä¸»è¿´åœˆ (è™•ç†å‹•ç•«èˆ‡ç¢°æ’)
            gameLoop();
        }

        // --- æ ¸å¿ƒåŠŸèƒ½ï¼šéŠæˆ²ä¸»è¿´åœˆ ---
        function gameLoop() {
            if (!isGameRunning) return;

            // 1. ç”¢ç”Ÿéšœç¤™ç‰©é‚è¼¯
            spawnTimer--;
            if (spawnTimer <= 0) {
                spawnObstacle();
                // æ ¹æ“šé€Ÿåº¦æ±ºå®šä¸‹ä¸€æ¬¡å‡ºç¾çš„æ™‚é–“ (é€Ÿåº¦è¶Šå¿«ï¼Œé–“éš”è¶ŠçŸ­)
                let minFrames = 60 / speedMultiplier;
                let maxFrames = 140 / speedMultiplier;
                spawnTimer = Math.floor(Math.random() * (maxFrames - minFrames + 1) + minFrames);
            }

            // 2. ç§»å‹•éšœç¤™ç‰© & ç¢°æ’åµæ¸¬
            moveObstacles();

            // 3. ç¹¼çºŒä¸‹ä¸€å¹€
            frameId = requestAnimationFrame(gameLoop);
        }

        // --- ç”¢ç”Ÿéšœç¤™ç‰© ---
        function spawnObstacle() {
            const obstacle = document.createElement('div');
            obstacle.classList.add('cactus');
            
            // 30% æ©Ÿç‡æ˜¯é«˜ä»™äººæŒ
            const isTall = Math.random() > 0.7;
            if (isTall) {
                obstacle.classList.add('cactus-tall');
            } else {
                obstacle.classList.add('cactus-small');
            }

            // è¨­å®šåˆå§‹ä½ç½® (ç•«é¢æœ€å³é‚Šå¤–å´)
            obstacle.style.left = '800px'; 
            
            gameWindow.appendChild(obstacle);
            obstacles.push(obstacle);
        }

        // --- ç§»å‹•èˆ‡ç¢°æ’åµæ¸¬ ---
        function moveObstacles() {
            const dinoRect = dino.getBoundingClientRect();

            for (let i = 0; i < obstacles.length; i++) {
                let obs = obstacles[i];
                
                // å–å¾—ç›®å‰ä½ç½®ä¸¦ç§»å‹•
                let currentLeft = parseFloat(obs.style.left);
                currentLeft -= gameSpeed;
                obs.style.left = currentLeft + 'px';

                // --- ç¢°æ’åµæ¸¬å€ ---
                const obsRect = obs.getBoundingClientRect();
                const padding = 15; // ç¢°æ’å¯¬å®¹åº¦ (æ•¸å€¼è¶Šå¤§è¶Šé›£æ’åˆ°)

                // æª¢æŸ¥é‡ç–Š
                if (
                    dinoRect.right - padding > obsRect.left + padding &&
                    dinoRect.left + padding < obsRect.right - padding &&
                    dinoRect.bottom - padding > obsRect.top + padding 
                ) {
                    gameOver();
                    return; // çµæŸè¿´åœˆ
                }

                // --- ç§»é™¤å€ ---
                // å¦‚æœéšœç¤™ç‰©è·‘å‡ºå·¦é‚Šç•«é¢ï¼Œå°±åˆªé™¤
                if (currentLeft < -100) {
                    obs.remove();
                    obstacles.splice(i, 1);
                    i--;
                }
            }
        }

        // --- å¢åŠ é€Ÿåº¦ ---
        function increaseSpeed() {
            if(speedMultiplier < 2.5) {
                speedMultiplier += 0.1;
                gameSpeed = 5 * speedMultiplier;
                speedEl.innerText = speedMultiplier.toFixed(1);
                
                // åŠ é€Ÿåœ°æ¿å‹•ç•«
                ground.style.animationDuration = (0.5 / speedMultiplier) + 's';
            }
        }

        // --- è·³èºåŠŸèƒ½ ---
        function jumpLow() {
            if(!isGameRunning) return;
            // é˜²æ­¢é€£è·³
            if (dino.classList.contains('anim-jump-low') || dino.classList.contains('anim-jump-high')) return;
            
            dino.classList.add('anim-jump-low');
            // å‹•ç•«çµæŸå¾Œç§»é™¤ class
            setTimeout(() => dino.classList.remove('anim-jump-low'), 500);
        }

        function jumpHigh() {
            if(!isGameRunning) return;
            if (dino.classList.contains('anim-jump-low') || dino.classList.contains('anim-jump-high')) return;
            
            dino.classList.add('anim-jump-high');
            setTimeout(() => dino.classList.remove('anim-jump-high'), 700);
        }

        // --- éŠæˆ²çµæŸè™•ç† ---
        function gameOver() {
            stopGame();
            msgEl.innerHTML = "<span style='color:red; font-size:1.5rem'>âŒ å“ˆå“ˆç‚¸äº†ï¼</span>";
            dino.innerText = "ğŸ’©"; // æé¾è®Šè‡‰
        }

        function gameWin() {
            stopGame();
            msgEl.innerHTML = "<span style='color:#27ae60; font-size:1.5rem'>ğŸ† å“ˆå“ˆè´äº†ï¼</span>";
            dino.innerText = "ğŸ«¦"; // æé¾è®Šè‡‰
        }

        function stopGame() {
            isGameRunning = false;
            hasGameEnded = true; // é–å®šéŠæˆ²ï¼Œä¸è®“å†æ¬¡é–‹å§‹
            
            clearInterval(timerInterval);
            cancelAnimationFrame(frameId);
            
            ground.classList.remove('scrolling-bg'); // åœæ­¢åœ°æ¿
            
            // æ°¸ä¹…é–å®šæŒ‰éˆ•
            startBtn.disabled = true;
            startBtn.innerText = "éŠæˆ²çµæŸ (è«‹F5é‡æ•´)";
            startBtn.style.cursor = "not-allowed";
        }

    </script>
</body>
</html>